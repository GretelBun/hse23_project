# hse23_project
## Структура проекта:

В папке raw_data лежат: мой белок SCARCA4, а также выровненные гистоны с помощью Muscle, в histones_muscle_full лежат все аминокислотные последовательности, а в histones_muscle по одной выбранные мной для каждого гистона.

В папке data лежат уже результаты работы команд: для каждого гистона и моего белка по папкам разбиты все файлы blast, а также итоговая таблица со значениями E-Value.

В папке scripts лежат все скрипты, которые я писала в терминале: add_index_proteomes - добавляет индексацию к базам, my_protein_blast - применяет команду blastp ко всем протеомам с моим белком, all_histones_blast - применяет команду blastp ко всем протеомам со всеми гистонами. 

В папке images все изображения с результатами. 

В освном все было сделано через терминал, но итоговая таблица обрабатывалась через питон, ссылка на коллаб: https://colab.research.google.com/drive/16n7WPc6iSDeBNSR8ayQMyQwv4EQLz_4T?usp=sharing. 

## Выбранные данные для проекта:
| Мой белок | H2A | H2B | H3 | H4 |
|-----------|-----|-----|----|----|
|    SCARCA4   | NP_613258.2 MACROH2A1    |   NP_066402.2 H2BC11  |  NP_003520.1 H3C1  |   NP_003529.1 H4C1 |

# Анализ выравниваний гистонов
Я постаралась сфоткать все выравнивания, но H2A был слишком длинным, поэтому у него сфоткала начало, конец и середину.
### H2A
Анализ: имеет больше всего изоформ. Можно заметить, что их можно поделить на группы по похожести. Нижние (28-42) имеют сильно больше гэпов, но между собой почти не отличаются, как и верхне-средние (5-21) между собой почти не отличаются. Остальные же имеют сильные отличия от этих двух больших групп. 

Вывод: изоформы гистона H2A не являются простыми копиями друг друга, а скорее представляют варианты, которые могут выполнять различные функции в клетке. Различия между изоформами могут быть обусловлены альтернативным сплайсированием, альтернативным началом или окончанием транскрипта, посттранскрипционными модификациями или другими механизмами регуляции экспрессии генов.

![H2A1](images/H2A1.png)
![H2A2](images/H2A2.png)
![H2A3](images/H2A3.png)
### H2B
Анализ: здесь также можно выделить две группы: до 21 и после, внутри группы они максимально похожи. 

Вывод: изоформы гистона H2B также не являются простыми копиями друг друга, а скорее представляют варианты, которые могут выполнять различные функции в клетке.

![H2B1](images/H2B1.png)
![H2B2](images/H2B2.png)
### H3
Анализ: все аминокислотные последовательности почти что идентичны. 

Вывод: в целом, наблюдаемая высокая схожесть аминокислотных последовательностей гистона H3 подчеркивает его важность и консервативность в клеточных процессах, связанных с упаковкой и регуляцией хроматина. Высокая схожесть может указывать на то, что гены H3 произошли от общего предка и подвергались консервативной эволюции. 

![H31](images/H31.png)
![H32](images/H32.png)
### H4
Анализ: все аминокислотные последовательности почти что идентичны. 

Вывод: в целом, наблюдаемая высокая схожесть аминокислотных последовательностей гистона H4 подчеркивает его важность и консервативность в клеточных процессах, связанных с упаковкой и регуляцией хроматина.

![H41](images/H41.png)
![H42](images/H42.png)


# Анализ blast файлов и тепловая карта
Начальная таблица:

|       | human    | mouse    | zebrafish    | c.elegans    | drosophila    | ciliate    | yeast    | methanocaldococcus    | thermococcus    | e.coli    | tuberculosis    |
|-------|----------|----------|--------------|--------------|---------------|------------|----------|-----------------------|-----------------|-----------|-----------------|
| H2A   | 0.0      | 0.0      | 0.0          | 2.71e-45     | 1.23e-43      | 3.44e-46   | 1.07e-45 | 1.2                   | 1.71e-07        | 1.18e-21  | 5.29e-09        |
| H2B   | 2.81e-88 | 1.01e-87 | 3.05e-83     | 2.78e-65     | 5.43e-60      | 6.56e-51   | 3.85e-60 | 1.7                   | 1.2             | 1.6       | 1.7             |
| H3    | 2.19e-96 | 1.54e-96 | 1.77e-95     | 4.46e-94     | 9.39e-96      | 8.41e-86   | 3.31e-87 | 0.034                 | 0.057           | 0.90      | 4.6             |
| H4    | 1.09e-67 | 7.60e-68 | 1.13e-68     | 6.15e-68     | 8.02e-68      | 1.96e-45   | 1.08e-52 | 8.22e-05              | 3.31e-05        | 1.3       | 0.069           |
| SMARCA4 | 0.0      | 0.0      | 0.0          | 0.0          | 0.0           | 0.0        | 0.0      | 0.39                  | 0.067           | 0.004     | 1.29e-53        |

Логарифмированная таблица:

|            | human  | mouse  | zebrafish | c.elegans | drosophila | ciliate | yeast  | methanocaldococcus | thermococcus | e.coli | tuberculosis |
|------------|--------|--------|-----------|-----------|------------|---------|--------|---------------------|--------------|--------|--------------|
| H2A        | 300.00 | 300.00 | 300.00    | 44.57     | 42.91      | 45.46   | 44.97  | 0.00                | 6.77         | 20.93  | 8.28         |
| H2B        | 87.55  | 86.99  | 82.52     | 64.56     | 59.27      | 50.18   | 59.41  | 0.00                | 0.00         | 0.00   | 0.00         |
| H3         | 95.66  | 95.81  | 94.75     | 93.35     | 95.03      | 85.08   | 86.48  | 1.47                | 1.24         | 0.05   | 0.00         |
| H4         | 66.96  | 67.12  | 67.95     | 67.21     | 67.10      | 44.71   | 51.97  | 4.08                | 4.48         | 0.00   | 1.16         |
| SMARCA4    | 300.00 | 300.00 | 300.00    | 300.00    | 300.00     | 300.00  | 300.00 | 0.41                | 1.17         | 2.40   | 52.89        |


Меньшие значения e-value указывают на более значимое сходство между белками и более высокую степень вероятности, что такое сходство является значимым. Белки H2A и SMARCA4 имеют минимальное значение e-value 0.0 для всех организмов, что указывает на высокую степень сходства между этими белками у всех исследуемых организмов. Белки H2B и H3 также показывают низкие значения e-value для большинства организмов.

В результате работы была получена следующая тепловая карта:

![hits](images/hits.png)

Стоит отметить, что значение 300 было введено искуственно, так как нужно было заменить 0 на какое-то очень маленькое число, если в данном случае брать $10^{-100}$, то тепловая карта будет более усредненной (так как сейчас 300 далек от реального максимума ~96). В лекции просили заменять 0 на $10^{-100}$, но для себя я также сделала карту с $10^{-100}$:

![hits](images/hits100.png)

Как и было предположено на лекции, можно заметить, что все белки имеют хорошие попадания в большенстве организмов, за исключением архей и бактерий. Также видим, что максимальное попадание имеет H2A с многоклеточными позвоночными, а также мой белок SMARCA4 с многоклеточными позвоночными, многоклеточными беспозвоночными и одноклеточными эукартиотами. Также интересно, что H3, с модификацией которого исследовался мой белок, имеет почти максимальные значения у тех же организмов, что и SMARCA4 и в целом максимально приближен по распределению значений к нему. Исходя из вышеперечисленных данных, можно предположить, что белок SMARCA4 появился в очень ранних стадиях эволюции. Его существование можно проследить в большенстве организмах. 